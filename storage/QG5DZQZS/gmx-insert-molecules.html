<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns=http://www.w3.org/1999/xhtml class="doihhe idc0_340" style><!--
 Page saved with SingleFile 
 url: https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-insert-molecules.html 
 saved date: Tue May 31 2022 17:47:46 GMT-0400 (Eastern Daylight Time)
--><meta charset=utf-8>
<title>gmx insert-molecules — GROMACS 2019 documentation</title>
<style>div.clearer{clear:both}div.related{width:100%;font-size:90%}div.related ul{margin:0;padding:0 0 0 10px;list-style:none}div.related li{display:inline}div.related li.right{float:right;margin-right:5px}div.sphinxsidebarwrapper{padding:10px 5px 0 10px}div.sphinxsidebar{float:left;width:230px;margin-left:-100%;font-size:90%;word-wrap:break-word;overflow-wrap:break-word}div.sphinxsidebar ul{list-style:none}div.sphinxsidebar ul ul{margin-left:20px;list-style:square}div.sphinxsidebar ul ul{margin-top:0;margin-bottom:0}div.sphinxsidebar form{margin-top:10px}div.sphinxsidebar #searchbox input[type="text"]{width:170px}div.body p,div.body dd{-moz-hyphens:auto;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}a.headerlink{visibility:hidden}h1:hover>a.headerlink,h2:hover>a.headerlink,h3:hover>a.headerlink,h4:hover>a.headerlink,h5:hover>a.headerlink,h6:hover>a.headerlink,dt:hover>a.headerlink,caption:hover>a.headerlink,p.caption:hover>a.headerlink,div.code-block-caption:hover>a.headerlink{visibility:visible}dl{margin-bottom:15px}dd{margin-top:3px;margin-bottom:10px;margin-left:30px}dt:target,.highlighted{background-color:#fbe54e}pre{overflow:auto;overflow-y:hidden}span.pre{-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;hyphens:none}body{font-family:sans-serif;font-size:100%;background-color:#11303d;color:#000;margin:0;padding:0}div.document{background-color:#1c4e63}div.documentwrapper{float:left;width:100%}div.bodywrapper{margin:0 0 0 230px}div.body{background-color:#ffffff;color:#000000;padding:0 20px 30px 20px}div.footer{color:#ffffff;width:100%;padding:9px 0 9px 0;text-align:center;font-size:75%}div.footer a{color:#ffffff;text-decoration:underline}div.related{background-color:#133f52;line-height:30px;color:#ffffff}div.related a{color:#ffffff}div.sphinxsidebar h3{font-family:'Trebuchet MS',sans-serif;color:#ffffff;font-size:1.4em;font-weight:normal;margin:0;padding:0}div.sphinxsidebar h3 a{color:#ffffff}div.sphinxsidebar h4{font-family:'Trebuchet MS',sans-serif;color:#ffffff;font-size:1.3em;font-weight:normal;margin:5px 0 0 0;padding:0}div.sphinxsidebar p{color:#ffffff}div.sphinxsidebar p.topless{margin:5px 10px 10px 10px}div.sphinxsidebar ul{margin:10px;padding:0;color:#ffffff}div.sphinxsidebar a{color:#98dbcc}div.sphinxsidebar input{border:1px solid #98dbcc;font-family:sans-serif;font-size:1em}a{color:#355f7c;text-decoration:none}a:visited{color:#355f7c;text-decoration:none}a:hover{text-decoration:underline}div.body h1,div.body h2{font-family:'Trebuchet MS',sans-serif;background-color:#f2f2f2;font-weight:normal;color:#20435c;border-bottom:1px solid #ccc;margin:20px -20px 10px -20px;padding:3px 0 3px 10px}div.body h1{margin-top:0;font-size:200%}div.body h2{font-size:160%}a.headerlink{color:#c60f0f;font-size:0.8em;padding:0 4px 0 4px;text-decoration:none}a.headerlink:hover{background-color:#c60f0f;color:white}div.body p,div.body dd{text-align:justify;line-height:130%}pre{padding:5px;background-color:#eeffcc;color:#333333;line-height:120%;border:1px solid #ac9;border-left:none;border-right:none}code{background-color:#ecf0f3;padding:0 1px 0 1px;font-size:0.95em}</style>
<link rel=index title=Index href=https://manual.gromacs.org/documentation/2019/genindex.html>
<link rel=search title=Search href=https://manual.gromacs.org/documentation/2019/search.html>
<link rel=next title="gmx lie" href=https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-lie.html>
<link rel=prev title="gmx hydorder" href=https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-hydorder.html>
<style>#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0px;padding:2px 8px;z-index:102;color:black;font-size:80%;width:auto;white-space:nowrap}</style><link type=image/x-icon rel="shortcut icon" href="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><style>.sf-hidden{display:none!important}</style><link rel=canonical href=https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-insert-molecules.html><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:;"></head>
 <body><div id=MathJax_Message style=display:none></div>
 <div class=related role=navigation aria-label="related navigation">
 <h3 class=sf-hidden>Navigation</h3>
 <ul>
 <li class=right style=margin-right:10px>
 <a href=https://manual.gromacs.org/documentation/2019/genindex.html title="General Index" accesskey=I>index</a></li>
 <li class=right>
 <a href=https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-lie.html title="gmx lie" accesskey=N>next</a> |</li>
 <li class=right>
 <a href=https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-hydorder.html title="gmx hydorder" accesskey=P>previous</a> |</li>
 <li class="nav-item nav-item-0"><a href=https://manual.gromacs.org/documentation/2019/index.html>GROMACS 2019</a> »</li>
 <li class="nav-item nav-item-1"><a href=https://manual.gromacs.org/documentation/2019/user-guide/index.html>User guide</a> »</li>
 <li class="nav-item nav-item-2"><a href=https://manual.gromacs.org/documentation/2019/user-guide/cmdline.html accesskey=U>Command-line reference</a> »</li> 
 </ul>
 </div> 
 <div class=document>
 <div class=documentwrapper>
 <div class=bodywrapper>
 <div class=body role=main>
 
 <div class=section id=gmx-insert-molecules>
<span id=id1></span><h1>gmx insert-molecules<a class=headerlink href=#gmx-insert-molecules title="Permalink to this headline">¶</a></h1>
<div class=section id=synopsis>
<h2>Synopsis<a class=headerlink href=#synopsis title="Permalink to this headline">¶</a></h2>
<pre class=literal-block>gmx insert-molecules [<strong>-f</strong> <em>[&lt;.gro/.g96/...&gt;]</em>] [<strong>-ci</strong> <em>[&lt;.gro/.g96/...&gt;]</em>]
             [<strong>-ip</strong> <em>[&lt;.dat&gt;]</em>] [<strong>-n</strong> <em>[&lt;.ndx&gt;]</em>] [<strong>-o</strong> <em>[&lt;.gro/.g96/...&gt;]</em>]
             [<strong>-replace</strong> <em>&lt;selection&gt;</em>] [<strong>-sf</strong> <em>&lt;file&gt;</em>] [<strong>-selrpos</strong> <em>&lt;enum&gt;</em>]
             [<strong>-box</strong> <em>&lt;vector&gt;</em>] [<strong>-nmol</strong> <em>&lt;int&gt;</em>] [<strong>-try</strong> <em>&lt;int&gt;</em>] [<strong>-seed</strong> <em>&lt;int&gt;</em>]
             [<strong>-radius</strong> <em>&lt;real&gt;</em>] [<strong>-scale</strong> <em>&lt;real&gt;</em>] [<strong>-dr</strong> <em>&lt;vector&gt;</em>]
             [<strong>-rot</strong> <em>&lt;enum&gt;</em>]
</pre>
</div>
<div class=section id=description>
<h2>Description<a class=headerlink href=#description title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class=pre>gmx</span> <span class=pre>insert-molecules</span></code> inserts <code class="docutils literal"><span class=pre>-nmol</span></code> copies of the system specified in
the <code class="docutils literal"><span class=pre>-ci</span></code> input file. The insertions take place either into
vacant space in the solute conformation given with <code class="docutils literal"><span class=pre>-f</span></code>, or
into an empty box given by <code class="docutils literal"><span class=pre>-box</span></code>. Specifying both <code class="docutils literal"><span class=pre>-f</span></code>
and <code class="docutils literal"><span class=pre>-box</span></code> behaves like <code class="docutils literal"><span class=pre>-f</span></code>, but places a new box
around the solute before insertions. Any velocities present are
discarded.</p>
<p>It is possible to also insert into a solvated configuration and
replace solvent atoms with the inserted atoms. To do this, use
<code class="docutils literal"><span class=pre>-replace</span></code> to specify a selection that identifies the atoms
that can be replaced. The tool assumes that all molecules in this
selection consist of single residues: each residue from this
selection that overlaps with the inserted molecules will be removed
instead of preventing insertion.</p>
<p>By default, the insertion positions are random (with initial seed
specified by <code class="docutils literal"><span class=pre>-seed</span></code>). The program iterates until <code class="docutils literal"><span class=pre>-nmol</span></code>
molecules have been inserted in the box. Molecules are not inserted
where the distance between any existing atom and any atom of the
inserted molecule is less than the sum based on the van der Waals
radii of both atoms. A database (<code class="docutils literal"><span class=pre>vdwradii.dat</span></code>) of van der
Waals radii is read by the program, and the resulting radii scaled
by <code class="docutils literal"><span class=pre>-scale</span></code>. If radii are not found in the database, those
atoms are assigned the (pre-scaled) distance <code class="docutils literal"><span class=pre>-radius</span></code>.
Note that the usefulness of those radii depends on the atom names,
and thus varies widely with force field.</p>
<p>A total of <code class="docutils literal"><span class=pre>-nmol</span></code> * <code class="docutils literal"><span class=pre>-try</span></code> insertion attempts are made
before giving up. Increase <code class="docutils literal"><span class=pre>-try</span></code> if you have several small
holes to fill. Option <code class="docutils literal"><span class=pre>-rot</span></code> specifies whether the insertion
molecules are randomly oriented before insertion attempts.</p>
<p>Alternatively, the molecules can be inserted only at positions defined in
positions.dat (<code class="docutils literal"><span class=pre>-ip</span></code>). That file should have 3 columns (x,y,z),
that give the displacements compared to the input molecule position
(<code class="docutils literal"><span class=pre>-ci</span></code>). Hence, if that file should contain the absolute
positions, the molecule must be centered on (0,0,0) before using
<code class="docutils literal"><span class=pre>gmx</span> <span class=pre>insert-molecules</span></code> (e.g. from <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-editconf.html><span class=doc>gmx editconf</span></a> <code class="docutils literal"><span class=pre>-center</span></code>).
Comments in that file starting with # are ignored. Option <code class="docutils literal"><span class=pre>-dr</span></code>
defines the maximally allowed displacements during insertial trials.
<code class="docutils literal"><span class=pre>-try</span></code> and <code class="docutils literal"><span class=pre>-rot</span></code> work as in the default mode (see above).</p>
</div>
<div class=section id=options>
<h2>Options<a class=headerlink href=#options title="Permalink to this headline">¶</a></h2>
<p>Options to specify input files:</p>
<dl class=docutils>
<dt><code class="docutils literal"><span class=pre>-f</span></code> [&lt;.gro/.g96/…&gt;] (protein.gro) (Optional)</dt>
<dd>Existing configuration to insert into: <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#gro><span class="std std-ref">gro</span></a> <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#g96><span class="std std-ref">g96</span></a> <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#pdb><span class="std std-ref">pdb</span></a> brk ent esp <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#tpr><span class="std std-ref">tpr</span></a></dd>
<dt><code class="docutils literal"><span class=pre>-ci</span></code> [&lt;.gro/.g96/…&gt;] (insert.gro)</dt>
<dd>Configuration to insert: <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#gro><span class="std std-ref">gro</span></a> <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#g96><span class="std std-ref">g96</span></a> <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#pdb><span class="std std-ref">pdb</span></a> brk ent esp <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#tpr><span class="std std-ref">tpr</span></a></dd>
<dt><code class="docutils literal"><span class=pre>-ip</span></code> [&lt;.dat&gt;] (positions.dat) (Optional)</dt>
<dd>Predefined insertion trial positions</dd>
<dt><code class="docutils literal"><span class=pre>-n</span></code> [&lt;.ndx&gt;] (index.ndx) (Optional)</dt>
<dd>Extra index groups</dd>
</dl>
<p>Options to specify output files:</p>
<dl class=docutils>
<dt><code class="docutils literal"><span class=pre>-o</span></code> [&lt;.gro/.g96/…&gt;] (out.gro)</dt>
<dd>Output configuration after insertion: <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#gro><span class="std std-ref">gro</span></a> <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#g96><span class="std std-ref">g96</span></a> <a class="reference internal" href=https://manual.gromacs.org/documentation/2019/reference-manual/file-formats.html#pdb><span class="std std-ref">pdb</span></a> brk ent esp</dd>
</dl>
<p>Other options:</p>
<dl class=docutils>
<dt><code class="docutils literal"><span class=pre>-replace</span></code> &lt;selection&gt;</dt>
<dd>Atoms that can be removed if overlapping</dd>
<dt><code class="docutils literal"><span class=pre>-sf</span></code> &lt;file&gt;</dt>
<dd>Provide selections from files</dd>
<dt><code class="docutils literal"><span class=pre>-selrpos</span></code> &lt;enum&gt; (atom)</dt>
<dd>Selection reference positions: atom, res_com, res_cog, mol_com, mol_cog, whole_res_com, whole_res_cog, whole_mol_com, whole_mol_cog, part_res_com, part_res_cog, part_mol_com, part_mol_cog, dyn_res_com, dyn_res_cog, dyn_mol_com, dyn_mol_cog</dd>
<dt><code class="docutils literal"><span class=pre>-box</span></code> &lt;vector&gt; (0 0 0)</dt>
<dd>Box size (in nm)</dd>
<dt><code class="docutils literal"><span class=pre>-nmol</span></code> &lt;int&gt; (0)</dt>
<dd>Number of extra molecules to insert</dd>
<dt><code class="docutils literal"><span class=pre>-try</span></code> &lt;int&gt; (10)</dt>
<dd>Try inserting <code class="docutils literal"><span class=pre>-nmol</span></code> times <code class="docutils literal"><span class=pre>-try</span></code> times</dd>
<dt><code class="docutils literal"><span class=pre>-seed</span></code> &lt;int&gt; (0)</dt>
<dd>Random generator seed (0 means generate)</dd>
<dt><code class="docutils literal"><span class=pre>-radius</span></code> &lt;real&gt; (0.105)</dt>
<dd>Default van der Waals distance</dd>
<dt><code class="docutils literal"><span class=pre>-scale</span></code> &lt;real&gt; (0.57)</dt>
<dd>Scale factor to multiply Van der Waals radii from the database in share/gromacs/top/vdwradii.dat. The default value of 0.57 yields density close to 1000 g/l for proteins in water.</dd>
<dt><code class="docutils literal"><span class=pre>-dr</span></code> &lt;vector&gt; (0 0 0)</dt>
<dd>Allowed displacement in x/y/z from positions in <code class="docutils literal"><span class=pre>-ip</span></code> file</dd>
<dt><code class="docutils literal"><span class=pre>-rot</span></code> &lt;enum&gt; (xyz)</dt>
<dd>Rotate inserted molecules randomly: xyz, z, none</dd>
</dl>
</div>
</div>
 </div>
 </div>
 </div>
 <div class=sphinxsidebar role=navigation aria-label="main navigation">
 <div class=sphinxsidebarwrapper>
 <h3><a href=https://manual.gromacs.org/documentation/2019/index.html>Table Of Contents</a></h3>
 <ul>
<li><a class="reference internal" href=#>gmx insert-molecules</a><ul>
<li><a class="reference internal" href=#synopsis>Synopsis</a></li>
<li><a class="reference internal" href=#description>Description</a></li>
<li><a class="reference internal" href=#options>Options</a></li>
</ul>
</li>
</ul>
 <h4>Previous topic</h4>
 <p class=topless><a href=https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-hydorder.html title="previous chapter">gmx hydorder</a></p>
 <h4>Next topic</h4>
 <p class=topless><a href=https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-lie.html title="next chapter">gmx lie</a></p>
 <div role=note aria-label="source link">
 <h3>This Page</h3>
 <ul class=this-page-menu>
 <li><a href=https://manual.gromacs.org/documentation/2019/_sources/onlinehelp/gmx-insert-molecules.rst.txt rel=nofollow>Show Source</a></li>
 </ul>
 </div>
<div id=searchbox role=search>
 <h3>Quick search</h3>
 <form class=search action=../search.html>
 <div><input type=text name=q value></div>
 <div><input type=submit value=Go></div>
 
 
 </form>
</div>
 </div>
 </div>
 <div class=clearer></div>
 </div>
 <div class=related role=navigation aria-label="related navigation">
 <h3 class=sf-hidden>Navigation</h3>
 <ul>
 <li class=right style=margin-right:10px>
 <a href=https://manual.gromacs.org/documentation/2019/genindex.html title="General Index">index</a></li>
 <li class=right>
 <a href=https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-lie.html title="gmx lie">next</a> |</li>
 <li class=right>
 <a href=https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-hydorder.html title="gmx hydorder">previous</a> |</li>
 <li class="nav-item nav-item-0"><a href=https://manual.gromacs.org/documentation/2019/index.html>GROMACS 2019</a> »</li>
 <li class="nav-item nav-item-1"><a href=https://manual.gromacs.org/documentation/2019/user-guide/index.html>User guide</a> »</li>
 <li class="nav-item nav-item-2"><a href=https://manual.gromacs.org/documentation/2019/user-guide/cmdline.html>Command-line reference</a> »</li> 
 </ul>
 </div>
 <div class=footer role=contentinfo>
 © Copyright 2018, GROMACS development team.
 Created using <a href=http://sphinx-doc.org/>Sphinx</a> 1.6.1.
 </div>
 
