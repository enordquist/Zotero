doi:10.1006/jmbi.2000.3670 available online at http://www.idealibrary.com on

J. Mol. Biol. (2000) 298, 313±328

SH3-SPOT: An Algorithm to Predict Preferred Ligands to Different Members of the SH3 Gene Family
Barbara Brannetti, Allegra Via, Gianluca Cestra, Gianni Cesareni and Manuela Helmer Citterich*

Centro di Bioinformatica Molecolare, Department of Biology, University of Rome ``Tor Vergata'', via della Ricerca Scienti®ca 00133, Rome, Italy
*Corresponding author

We have developed a procedure to predict the peptide binding speci®city of an SH3 domain from its sequence. The procedure utilizes information extracted from position-speci®c contacts derived from six SH3/peptide or SH3/protein complexes of known structure. The framework of SH3/peptide contacts de®ned on the structure of the complexes is used to build a residue-residue interaction database derived from ligands obtained by panning peptide libraries displayed on ®lamentous phage.
The SH3-speci®c interaction database is a multidimensional array containing frequencies of position-speci®c contacts. As input, SH3-SPOT requires the sequence of an SH3 domain and of a query decapeptide ligand. The array, that we call the SH3-speci®c matrix, is then used to evaluate the probability that the peptide would bind the given SH3 domain. This procedure is fast enough to be applied to the entire protein sequence database.
Panning experiments were performed to search putative speci®c ligands of different SH3 domains in a database of decapeptides, or in a database of protein sequences. The procedure ranked some of the natural partners of interaction of a number of SH3 domains among the best ligands of the $5.6 Â 109 different decapeptides in the SWISSPROT database. We expect the predictive power of the method to increase with the enrichment of the SH3-speci®c matrix by interaction data derived from new complex structures or from the characterization of new ligands. The procedure was developed using the SH3 domain family as test case but its application can easily be extended to other families of protein domains (such as, SH2, MHC, EH, PDZ, etc.).
# 2000 Academic Press
Keywords: SH3 domain; prediction; speci®city; protein/peptide interaction; bioinformatics

Introduction
The formation of macromolecular complexes in the cell is often mediated by relatively small protein recognition modules which are found repeatedly in several protein structures. Each domain family (SH3, SH2, EH, PDZ, WW, etc.) binds to peptides displaying speci®c sequence and structural characteristics. For instance, SH2 binds to peptides containing phosphotyrosine residues while PDZ prefers peptides with a free carboxy terminus. Within each domain family, speci®city is modulated by varying the chemical properties of
Abbreviations used: SH3, Src homology 3. e-mail address of the corresponding author: citterich@uniroma2.it

the module binding surface, which in turn determines a preference for peptides within a range of variability on the common structural theme.
Among these module families, SH3 is the best represented in the proteins characterized so far. A cBLAST search (Altschul et al., 1997) in the SWISSPROT database reveals more than 250 hits. These proteins are involved in a variety of cellular processes as diverse as signal transduction, cytoskeletal organization, membrane traf®c or organelle assembly (Stahl et al., 1988; Trahey et al., 1988; Sahr et al, 1990; Otsu et al., 1991; Musacchio et al., 1994a).
All SH3 domains fold into a compact structure formed by two antiparallel, four-stranded b-sheets connected by loops of different length (Musacchio

0022-2836/00/020313±16 $35.00/0

# 2000 Academic Press

314

Prediction of SH3 Domain Speci®city

et al., 1992). The two b-sheets interact at a rightangle to form a modi®ed b-barrel.
The solution of the structure of several SH3 domains complexed with peptide ligands and the analysis of preferred SH3 ligands, as determined by screening peptide repertoires, has led us to propose a general model of peptide recognition mediated by SH3 domains.
According to this model, SH3 ligands are characterized by a PxxP motif and recognize the SH3 binding surface in a polyproline helix type II conformation in one of two opposite orientations. The two proline residues of the core motif occupy two hydrophobic pockets, formed by aromatic residues that are conserved in most SH3 domains. The third binding pocket is lined by negative residues and can host a positively charged side-chain. Ligand orientation depends on the position of the positive residue in the target peptide. Peptides that bind in a type I orientation conform to the consensus RxLPxZP (where Z is normally a hydrophobic or an Arg residue as in PI3K binding peptides), while peptides characterized by the #Px#PxR consensus (type II, where # is a hydrophobic residue) bind in the opposite orientation. The residues in bold occupy the sites in the hydrophobic pocket that are normally referred to as PÀ1, P0 P2 and P3 (Figure 1), while the Arg residue occupies site PÀ3. Different SH3 domains display different preferences for more or less subtle variations of the common motif on the polyproline peptide. A notable exception to this model is represented by the SH3 of Abl which prefers peptides that have an aromatic residue instead of the positively charged residue at PÀ3. These peptides are positioned in the SH3 binding pocket in a type I orientation. More recently, a growing number of SH3 domains have been reported to bind preferentially to peptides that cannot be easily reconciled with this model (Cestra et al., 1999; MongiovÁõ et al., 1999).
SH3 protein recognition can also be modulated by contacts with other target regions that may be located far from the polyproline peptide (Lee et al., 1996). Furthermore, in vivo other factors like protein localization in a speci®c cell compartment and increase of local concentration, mediated by other protein interactions, are very important in determining whether a speci®c SH3 will ever encounter its ``in vitro predicted'' partner. These latter considerations are particularly important in the case of SH3 domains that bind to their partners with relatively low af®nities (ranging from 100 nM to 10 mM).
To summarize, in vivo partner selection, mediated by a speci®c protein recognition module, is in¯uenced by three factors: (1) peptide binding speci®city; (2) stabilization by extra contacts; and (3) local partner concentration.
Theoretical methods have been applied to the analysis of SH3 domains speci®city such as: computer simulation of protein-protein interaction (Pisabarro & Serrano, 1996; Pisabarro et al., 1998) or protein docking programs (unpublished results).

Figure 1. SH3 domain and peptide-contacting positions. The Abl SH3 domain and peptide complex was used to describe a generic SH3/peptide contact. The SH3 domain is represented with a solvent-accessible surface generated with the WebLab Pro program, M.S.I. The trace of the peptide is in red. The positions identi®ed in the SH3 multiple alignment are reported in white on the SH3 surface and the positions from PÀ6 to P3 are reported in white boxes in the corresponding positions of the peptide. The SH3 residues which were shown to correlate with the preference for a particular ligand residue, as discussed in Table 2, are in color; cyan and blue regions determine recognition speci®city only of class I and class II peptides, respectively. Residues that were found to be important for recognition speci®city in both ligand classes are in dark blue.
These methods can be applied only when the 3D structures of the protein moieties are known, or, alternatively, when reliable molecular models can be obtained.
We set as our goal the development of an algorithm (SPOT: Speci®city Prediction Of Target) that could predict peptide recognition speci®city of any newly discovered SH3 domain from its sequence. The information extracted from the structure of SH3/peptide complexes and from the analysis of multiple alignments is used to organize the experimental data obtained by panning peptide repertoires displayed on ®lamentous phage capsids.
The results of the panning experiments are organized in contact matrices which describe, for each SH3/peptide contact position, the frequency of occurrence of any speci®c pair of residues in the SH3 and in the ligand peptide. The matrices are then used to evaluate the probability of interaction between different SH3 domains and a given peptide (Figure 2).

Prediction of SH3 Domain Speci®city

315

Figure 2. Scheme of the SH3-SPOT procedure. The procedure takes as input a multiple alignment of SH3 sequences (the sequence of the query SH3 is in red) and the database of decapeptides or proteins to be evaluated for af®nity to the query SH3 sequence. An SH3-speci®c matrix is built from contact data extracted from SH3/peptide complexes of known structure and from phage display data (Table 1), as described in Methods. The SH3-speci®c matrix associates to each SH3/peptide contact position the frequency of occurrence of any speci®c pair of residues extracted from the database of experimental contacts. The matrix is then used to evaluate the probability of interaction between different SH3 domains and a given peptide.

SPOT can be applied to any family of protein recognition domains for which both structural information about at least one protein-peptide complex and binding data between different domain-peptide sequences are available.
Results
Class I and class II contact matrices
In order to construct contact matrices we identi®ed the positions, on the SH3 binding surface, that are suf®ciently close to the ligand and may therefore contribute to binding speci®city. These are likely to vary in the different SH3s and may depend on the speci®c ligand considered. To avoid missing residues that may turn out to be important in de®ning ligand preference in SH3 domains of unknown structure, we have used a somewhat loose de®nition of residue contact (see Methods). Two residues are de®ned as being in contact when, in any of the six complexes of known crystallographic structure, the shortest distance between their atoms is less than the sum of their van der Waals radii 3 AÊ . Twenty-seven positions of the multiple alignment of SH3 sequences shown in Figure 3(a) are in contact with at least one residue of a ligand according to this criterion.
Thus, an SH3/ligand contact map is a 27 Â 10 matrix in which most elements are empty, while those corresponding to residues that are in ``contact'' contain information about the frequency of speci®c amino acid to amino acid contact in experimentally determined ligands.
Although Ca atoms of class I and class II peptides occupy similar positions in the SH3 binding pockets, we have considered the two types of complexes separately. This approach generated more accurate predictions than a similar approach in which the two types of complexes were considered

together. Overall the two contact maps are similar. However, some differences stand out as shown in Figure 3(b) in which ligand residues are named according to Lim et al. (1994) and SH3 residues according to the numbering in the Abl SH3 (Musacchio et al., 1994b): (1) only class I peptides are found to interact with the SH3 domain by making contacts at positions PÀ6 and PÀ5 in the SH3/ peptide complexes of known structure; (2) positions 77, 84, 93, 95, 100, and 101 of the SH3 multiple alignment make contact only with class I peptides; (3) positions 73, 97 and 116 of the multiple alignment make contact only with class II ligands.
Some of these differences may be due to the relatively small size of the database of SH3/peptide complexes available at the moment. This is particularly true for the absence of hits at positions PÀ5 and PÀ6 in the class II contact map. In three out of the four class II structures considered, in fact, the peptides in the complex are shorter and do not include residues at positions PÀ5 and PÀ6. In the 1efn structure (where the SH3 domain of the Hck kinase is complexed with the HIV Nef protein) the residues of the Nef protein corresponding to the positions PÀ5 and PÀ6 are not in contact with the SH3 residues. Since panning of peptides displayed by phage capsids reveals that recognition speci®city of class II peptides may be modulated by the residues present at PÀ5 and PÀ6, we decided to consider contacts between PÀ5 and SH3 positions 77, 78, 99 and 110, as well as contacts between PÀ6 and SH3 positions 99 and 110 to the class II array, as explained in Methods.
Analysis of the frequencies of specific contacts
The class I and class II SH3-speci®c matrices (Figure 3(b)) were calculated from the experimen-

316

Prediction of SH3 Domain Speci®city

Figure 3. Construction of SH3-speci®c matrices. (a) Multiple alignment of the SH3 domain sequences belonging to PDB complexes. The SH3 residues in contact with residues of the peptide are shown in bold. The 27 positions of the multiple alignment of SH3 sequences containing at least one SH3 contacting residue are boxed. (b) The columns of the table describe the 27 contacting position of the SH3 multiple alignment and are identi®ed with the residue numbering of the Abl SH3 structure (Musacchio et al., 1994b); the rows refer to the peptide positions with the P3 ,..., PÀ6 nomenclature as de®ned by Lim et al. (1994). The open elements of the table identify SH3 and peptide positions which are in contact (see Methods). The elements corresponding to SH3 and peptide positions which are not in contact are shown in grey. Contacts which are common to class I and class II complexes are marked with a dot. Contacts which are speci®c of the class I and class II complexes are marked with I and II. (c) Each one of the white elements of the SH3/peptide contact map shown in (b) contains a 20 Â 20 matrix where we calculate the frequency of interaction of all the possible residue/residue pairs in the de®ned SH3/peptide position. The matrix in (c) describes the interaction between SH3 position 110 and peptide position PÀ6. In the AY element, we tabulate the frequency of occurrence of Tyr in position 110 of SH3 sequences and of Ala in the PÀ6 position of the peptide ligands.

tally determined frequency of occurrence of amino acid x and y at any speci®c element of the contact map. These data were obtained from published and unpublished experiments of phage display and include 319 ligand peptides selected from 25 different SH3 domains, as described in Methods (Table 1). After normalization the maximum value, relative to a residue pair in a speci®c contact position is equal to 1. Due to the relatively small amount of contact information available, some of the ®gures in the two matrices have different degrees of statistical signi®cance. In other words, a high ®gure at position AxAy can be either derived from a single observation of a ligand containing amino acid x in contact with amino acid y on the SH3 binding surface or alternatively it can be obtained from several SH3 and ligands always showing x and y at those positions. More exper-

imental data are needed to eliminate this inconsistency.
Inspection of the values in the SH3-speci®c matrix reveals some correlation between residues in the SH3 and in the ligand that might turn out to be important in determining recognition speci®city. The most signi®cant are reported in Table 2.
Extracting contact information from the SH3specific matrices
The use of interaction matrices, such as the one that we have described, to predict domain-peptide binding is equivalent to describing the interaction between two proteins as the sum of independent interactions between their contacting residues.
In order to assess the reliability and limits of this assumption and the predictive power of the SH3-

Prediction of SH3 Domain Speci®city

317

Table 1. Database of SH3 domain complexes and number of selected peptides.

PDB code

SH3 protein Number of class I Number of class II

name

peptides

peptides

SH3 source

Reference

A.

1abo

Abl

1

1cka, 1ckb c-Crk

-

1efn

fyn mutant R96I

-

Tyrosine kinase

1fyn

Fyn

1

1sem

Sem-5

-

B.

1abo

Abl

30

Tyrosine kinase

1ad5

Hck

7

-

Amphiphysin

-

-

Cortactin

-

-

c-Crk

-

-

Endophilin1

3

-

Endophilin2

3

-

Endophilin3

9

1fmk

c-Src

56

1fyn

Fyn

13

1gbq

Grb2

19

-

Itk

5

-

Lyn

13

1ycs

P53bp2

-

1pht

Pi3

24

2hsp

Plc-g

-

-

myo3

8

-

myo5

13

1shg

Spectrin

5

-

Yes

11

TOTAL

221

-

Mus musculus Musacchio et al. (1994b)

2

Mus musculus Wu et al. (1995)

1

Homo sapiens Lee et al. (1996)

-

Homo sapiens Musacchio et al. (1994b)

1

Mus musculus Lim et al. (1994)

-

Mus musculus Sparks et al. (1996); Rickles et al. (1994)

-

Homo sapiens Cesareni et al. (unpublished)

12

Homo sapiens Cestra et al. (1999)

11

Mus musculus Sparks et al. (1996)

20

Gallus gallus Sparks et al. (1996)

-

Homo sapiens Cestra et al. (1999)

-

Homo sapiens Cestra et al. (1999)

-

Homo sapiens Cestra et al. (1999)

10

Homo sapiens Sparks et al. (1996); Rickles et al. (1994, 1995)

-

Homo sapiens Rickles et al. (1994, 1995)

13

Mus musculus Sparks et al. (1996)

-

Homo sapiens Bunnell et al. (1996)

-

Homo sapiens Rickles et al. (1994, 1995)

13

Homo sapiens Sparks et al. (1996)

4

Homo sapiens Rickles et al. (1994, 1995)

11

Homo sapiens Sparks et al. (1996)

-

S. cerevisiase Unpublished results

-

S. cerevisiase Unpublished results

-

Homo sapiens Unpublished results

-

Homo sapiens Sparks et al. (1996); Rickles et al. (1995)

98

speci®c matrices, we decided to: (1) evaluate the correlation between experimental and SPOT-predicted results on a de®ned dataset (see Methods); (2) compare the performance of different matrices obtained: (i) with all the available interaction data; and (ii) selectively removing data about single SH3 domains and performing predictions on SH3 domains which were or were not included in the experimental data utilized to calculate the matrices.
We want to assess whether the addition of new data to the matrices affects their performance in prediction and whether we can obtain a reliable prediction for an SH3 domain of unknown speci®city.
As a measure of success, we decided to use the correlation between the peptide sequences found in the phage display data (input) and the best scoring peptides (output) obtained using the different SH3-speci®c matrices. Each peptide list (either the input or the output list) can be described as a 10 Â 20 table (Figure 4(a) and (b)). The ten columns describe the ten ligand positions while in the rows we report the frequency with which the speci®c amino acid residues are observed in the ligand peptides at that position.
The correlation between the input and output 10 Â 20 tables is calculated as described in Methods and shown in Figure 4(c). In order to

evaluate the contribution of the different SH3 interaction data, we built different SH3-speci®c matrices (Table 3 and Figure 5) derived from the whole dataset of SH3/peptide interactions and from a dataset deprived of the interaction data derived from different SH3 domains. Each prediction was evaluated by calculating the correlation between the experimental and predicted results (see Table 3 and Figure 5).
The test performed with the Src (1fmk) SH3 domain as query sequence, using interaction data derived from experiments performed with different members of the Src family, shows that: when no interaction data about other SH3 domains of the Src family contribute to the matrix, the correlation between experimental and SPOT-predicted results is low ($0.6); the addition of an increasing number of experimental results obtained with SH3s of the Src family improves the correlation to 0.97. Interestingly a high correlation is also observed when the Src SH3 experimental data are not included in the training dataset. Similar results were obtained with the other SH3 domains of the Src family, as shown in Table 3 and Figure 5(a).
The Abl SH3 domain binds to polyproline peptides that are different in sequence from the classical RxxPxxP Src-type peptide. However, we could not detect a negative interference between Abl interaction data and data obtained with other SH3

318

Prediction of SH3 Domain Speci®city

Figure 4. Correlation between experimental and SPOT-predicted results with Abl SH3 used as query sequence. (a) Table describing the frequency of occurrence of the different peptide residues in the ten positions studied. In this example, the peptide list of the Abl peptides selected by the phage display panning technique is described; it is easy to see that the Abl peptides always display a proline residue in the P0 and P3 positions of the peptide, corresponding to the two proline residues in the canonic PxxP consensus sequence, respectively. There is a strong preference for a Pro residue in position PÀ1 and PÀ2. A preference for aromatic residues is displayed at position PÀ3 where other SH3 domains usually bind an Arg residue in the class I orientation (Lim et al., 1994). (b) Frequencies of the different residues in the ten positions of the 30 best scoring peptides SPOT-selected from the Abl SH3 domain in the database of 319 peptides. (c) A comparison can be made between the table describing the input peptide list, shown in (a), and the table obtained from the 30 best scoring peptides of the different test performed, shown in (b). The correlation r between the input and output tables is calculated according to the formula shown and as described in Methods.

domains of the Src family (see Table 3 and Figure 5(a)). The inclusion of up to six different sets of SH3/peptide binding data in the training dataset did not decrease the correlation between predicted and experimental results obtained with Abl SH3.
Similar tests were performed with the SH3 domains of the Abl family (Figure 5(b)).
In summary: (1) feeding the SH3-speci®c matrix experimental data obtained with different SH3 domains does not decrease the prediction performance on single SH3 test cases; (2) the recognition speci®city of a given SH3 can be successfully predicted if the SH3-speci®c matrix was derived from experimental data that include ligands of an SH3 domain that is related (belongs to the same family) to the query SH3 (Figure 5(a) and (b)).
Thus the approximation of considering the interaction between an SH3 domain and its ligand peptide as the sum of independent interactions between their contacting residues provides consistent results.
Database search results
SH3-SPOT was used to search the SWISSPROT (release 37) database of protein sequences with the Abl, Src, Hck, Fyn and Grb SH3 domains. The SWISSPROT release that we have used contains approximately 80,000 proteins (about 5.6 Â 109 decapeptides) that were scanned ®rst as class I and then as class II peptides.
SH3-SPOT evaluates the ``af®nity'' of an SH3 for any decapeptide and does not provide information about the potential interaction with a protein

containing the same peptide. In the context of the protein the peptide might be unavailable for interaction either because it is hidden inside the protein or because it is folded in a conformation different from the polyproline-type II helix. Furthermore, other contacts with distal parts of the protein might be important in establishing complex formation. Nevertheless, it is interesting to note that some of the known natural partners of the SH3 domains studied were ranked in the very ®rst positions of the score (as shown in Table 4), namely: (1) among the ten best scoring decapeptide ligands for the Abl SH3 domain, one peptide from the 3BP-2 protein was selected (Cicchetti et al., 1992); (2) the HIV Nef protein that is a characterized ligand of the Hck (1ad5) SH3 domain is ranked as one of the best ligands for Hck by SH3-SPOT (Saksela et al., 1995); (3) in the third position of the rank list obtained with the Src SH3 domain, one ®nds the voltage-gated potassium channel protein kv1.5. The SH3 domain of Src was observed to mediate the interaction with this protein (Holmes et al., 1996). (4) The best predicted ligand for the Grb2 SH3 domain is the Sos protein, a known natural ligand (Vidal et al., 1998). Among the top positions one also ®nds the proline-rich region of dynamin 1, another known ligand of Grb (Ando et al., 1994; Vidal et al., 1998); the Sos protein scores also in the ®rst positions of the Src and fyn SH3 domains (Park et al., 1998). (5) The cbl protooncogene is a natural partner of interaction of the Hck (Howlett et al., 1999), Grb (Park et al., 1998) and Fyn (Hunter et al., 1999) SH3 domains. This protein is found among the highest ranking

Prediction of SH3 Domain Speci®city

319

Table 2. Preferences for speci®c SH3 residue/peptide residue interactions

Peptide position

Class Ia

Class II

PÀ5

High values are reported for Y or P preferences related

A significant preference for Y in this position is found

to residues found in positions 76, 77, 78 and 110 of the

for 110F

multiple alignment.

PÀ4

A few SH3s display a preference for a P and they have

Generally an x; with 97G there is a significant preference

76N, or 77Q or 94D. Significant is the correlation

for P in this position; with 98Q a D is preferred

between 98N and a P

PÀ3 (R/K) 75R, 76T, 79D are correlated with a preference for an R

72Y, 73E, 73 K, 75Q, 76N, 78D, 94D and 111F are generally related to a preference for an R; 75N and 76D are (although less significantly) related to a preference for a K

PÀ2

Most SH3 domains do not select any specific residue at

x of the consensus; in two different SH3s a preference

this ligand position; 98N correlates with a preference

for P correlates with 98N

for R

P-1

72F, 98N, 111F or 111V, 113T, 114A indicate a preference P of the PxxP motif

for a P; 111I significantly prefers an L

P0

It corresponds to the first P in the PxxP conserved core

Uusually an x; single SH3 domains select L (74 K, 75E or

motif. Practically only P is tolerated

114T), V (75I) or R (115F) residues in this position

P1

This is usually an x of the consensus; however with

In a single SH3, a T in the 114th position of the

114A the P has a high score

alignment is always contacting a P

P2

-

P of the PxxP motif

P3

P of the PxxP motif

Usually an x; with 73N the P is significantly preferred; only associated with 70W and 115L a preference for R is detected

a Position-speci®c contact frequency between residues is considered when higher than 0.7 and when reported for more than one SH3 domain associated with a list of binding peptides. x represents any of the 20 amino acid residues.

positions of the lists of predicted peptide ligands for all of these domains.
Spectrin and Drk SH3 domains are structurally characterized, but little experimental information is known about their ligands. Spectrin (Spc) is a membrane skeletal protein that plays an important role in the establishment and maintenance of the cell shape and polarity. The Drk protein is an adaptor protein which displays strong homology to mammalian Grb2 and Caenorhabditis elegans SEM-5 and is composed of one SH2 and two SH3 domains. Experimental evidence of in vitro inter-

action is described between Spc SH3 domain and e3B1 kinase (Ziemnicka-Kotula et al., 1998) and between Drk SH3 domains and the Sos tail (Raabe et al., 1995). SH3-SPOT prediction (see Table 4) con®rms the interaction between Drk SH3 domain and the Sos protein, while the e3B1 kinase score is low in the Spc SH3 domain speci®city score.
We would like to emphasize that the only natural target included in the SH3-speci®c matrices used for this test is the Nef RPQVPLRPMT sequence, associated to the 1efn SH3 sequence (fyn mutant R96I), as shown in Table 1.

Table 3. Correlation between experimental and SPOT-predicted results when using different matrices.

Query SH3

À5

À4

À3

À2

À1

1fmk 1ad5 1fyn lyn yes 1abo

0.5996 0.5785 0.6588 0.5387 0.5449 0.9705

0.7454 0.7250 0.8068 0.6317 0.5843 0.9742

0.8762 0.8386 0.9122 0.7857 0.7714 0.9742

0.9613 0.8574 0.9228 0.8429 0.9253 0.9764

0.9640 0.8384 0.9098 0.8570 0.9279 0.9761

1abo Myo3 Myo5 Spc 1fmk

-

0.5548

0.5739

0.9603

0.9603

-

0.5324

0.6623

0.9432

0.9449

-

0.5283

0.9169

0.9269

0.9310

-

0.5811

0.6133

0.7680

0.7696

-

0.9694

0.9768

0.9688

0.9698

All
0.9698 0.8828 0.9229 0.9245 0.9469 0.9761
0.9761 0.9508 0.9337 0.8219 0.9698

Table 4. SWISSPROT results

Table 4 (continued)

Table 4 (continued)

Table 4 (continued)
a Name of the SH3 domain used for the panning experiment; the sequence of the preferred ligand is reported in bold and is calculated as described in Methods. Other residues with decreasing scores are reported under the preferred residue. The score corresponding to the preferred ligand is reported and is used to normalize the score values reported in the SH3-SPOT scores.
b The known natural partners of interaction are reported in bold; proteins which are known to interact with SH3 other than the query SH3 sequence are underlined.

324

Prediction of SH3 Domain Speci®city

Figure 5. Correlation plots obtained with different SH3-speci®c matrices (see Methods). Different SH3speci®c matrices were used in prediction tests on the SH3 sequences of members of the Src family (1fmk, 1ad5, 1fyn, 1lyn and 1yes) and of the Abl family (1abo, myo3, myo5 and spectrin). The different SH3 query domains were launched in SPOT prediction tests with SH3-speci®c matrices built with an increasing number of SH3 interaction data. In each test, the interaction data were added to the matrices according to increasing sequence similarity to the query SH3 domain, as evaluated with a FASTA comparison (see Methods). (a) Correlation tests performed with SH3 domains of the Src family; (b) correlation tests performed with the Abl SH3 domain family.
Discussion
The SH3-SPOT procedure is a new method to predict speci®city of peptide recognition mediated by SH3 domains. Information about the SH3/peptide contact positions are derived from six SH3 peptide complexes of known structure. The contact framework de®ned on the complexes of known structure is ®lled with contact data (virtual contacts) derived from SH3/peptide binding data obtained with the phage display technique. Information about position-speci®c SH3-residue/pep-

tide-residue contacts is stored in an SH3-speci®c matrix, where the frequency of occurrence of any pair of residues in the SH3 and in the ligand peptide is tabulated. The SH3-speci®c matrix is then used to evaluate the probability of interaction between SH3 domains and peptides (see Figure 2).
We analyzed the class I and class II SH3-speci®c matrices derived from our database of SH3/peptide contact data (Table 1) and report differences between the two binding modes (Figures 3(b) and 1). Some of these differences may be due to the relatively small size of the database of structures of SH3/peptide complexes. Nevertheless, analysis of the frequency of occurrence of the residue-residue contacts in the different SH3 and bound-peptide positions highlights the presence of SH3 positions which are consistently related to preferences for speci®c residues in the peptide ligand (Figure 1 and Table 2).
The procedure is based on the assumption that the interaction between two proteins can be described, in a ®rst approximation, as the sum of independent interactions between their contacting residues.
Test experiments were performed to support this rationale: a number of different SH3-speci®c matrices, containing interaction data extracted from an increasing number of SH3/peptide complexes, were used to predict the peptide recognition speci®city of SH3 domains that were not included in the training set. No negative interference was detected between data coming from SH3 domains of different families; a positive effect on the correlation between experimental and predicted results was obtained with the addition of interaction data coming from SH3 domains of the same family (see Figure 5(a) and (b)).
In the test case of the Src and Abl SH3 families, we observed a good correlation between experimental and predicted values even when the speci®c SH3 considered had not been included in the training set. Despite the relatively large number of experimental data considered, our SH3 speci®c matrix is still largely incomplete. It is likely that the SH3 domains characterized by phage display represent a biased selection within the SH3 domain family. The SH3 family multiple sequence alignment contains 632 members (Bateman et al., 1999). The SH3 domains of known speci®city are not evenly interspersed among the branches of the corresponding similarity tree. We estimate that the matrix that we have assembled, in each single contact position does not contain information for approximately 25 % of the known SH3 domains. The results that we have presented indicate that we can con®dently predict recognition speci®city of SH3 domains belonging to the two families (Src and Abl) represented in our experimental data set. However, distantly related SH3 are likely to be wrongly predicted by SPOT.
We are currently collecting more SH3/peptide data obtained from SH3 domains belonging to different families. We expect correlation between

Prediction of SH3 Domain Speci®city

325

experimental and predicted results to increase together with the increase of contact information.
In principle, the SH3-SPOT procedure scores decapeptide sequences and cannot evaluate the potential interaction between an SH3 domain and the entire protein. It is interesting to note that, nevertheless, some of the known natural partners of the SH3 domains studied were ranked in the very ®rst positions of the SPOT rank list (as shown in Table 4). A few experimentally determined interactions were correctly predicted: (1) the Abl SH3 domain and the 3BP-2 protein; (2) the Hck SH3 domain with the proto-oncogene c-cbl and the HIV Nef protein; (3) the src SH3 domain with the proto-oncogene c-cbl, the potassium channel protein kv1.5 and the Son of sevenless 1 and 2 proteins; (4) the fyn SH3 domain with the protooncogene c-cbl and the Son of sevenless 1 and 2 proteins; (5) the grb SH3 domain and the Son of sevenless 1 and 2 proteins, dynamin 1 and 3 proteins, and c-cbl. It is also possible that some interactions that were predicted from SPOT have not yet been detected in experimental studies.
The evaluation method used by SPOT differs from a simple sequence search in a protein database performed with an experimentally determined consensus. In fact each SH3/peptide pair is evaluated with scores related to the observed frequencies of residue-residue interaction and does not depend on any residue substitution matrix. Furthermore SPOT is designed to predict the preferred ligand of SH3 domains whose speci®city has not been determined experimentally.
Finally, the SPOT method, i.e. the construction of a structure-speci®c matrix and the use of domain/ligand position speci®c contacts to evaluate the probability of interaction, can easily be extended to other families of protein domains where at least one crystal structure of the proteinligand complex is known and interaction data obtained with combinatorial methods are available.
Methods
Database of SH3 complex structures and phage display data
We used the Protein Data Bank (Bernstein et al., 1977) coordinates of the following SH3/peptide or SH3/protein complexes: 1abo, 1cka, 1ckb, 1efn, 1fyn, 1sem (Table 1A). These complexes represent the six SH3 domain/peptide structures solved by X-ray diffraction. In these complexes the bound peptide is always in the standard polyproline II conformation. We did not consider the p53 tumor suppressor bound to the 53bp2 SH3 domain (PDB code: 1ycs), where the peptide bound into the SH3 pocket displays an unusual non-polyproline II conformation. Our database of SH3/peptide interaction includes 319 ligand peptides selected from 25 different SH3 domains (Table 1B).

Multiple alignment of SH3 sequences
We produced a multiple alignment (Figure 3(a)) of the SH3 sequences belonging to the SH3/peptide complexes of known structure. The PILEUP program of the Wisconsin Package software (Genetics Computer Group (GCG), 1999) was initially used to align the sequences of the SH3 domains whose structure, complexed with a ligand peptide, has been determined by X-ray crystallography. The alignment was then structurally re®ned in the SH3 binding regions using the pro®le3D software (De Rinaldis et al., 1998). Thereby we generated a 3D multiple superposition of SH3 domains, based on the optimization of surface similarity. We then aligned in the same column of the multiple sequence alignment the residues situated in the same element of the 3D motif grid of the SH3 surface multiple alignment.
Definition of contacts and virtual contacts in the SH3/peptide complexes
Two residues were de®ned in contact if, in any of the six complexes of known crystallographic structure, the smallest distance between their atoms is less than the sum of the van der Waals radii 3 AÊ . The SH3 residues in contact with residues of the peptide are shown in bold in Figure 3(a): 27 positions of the multiple alignment of SH3 sequences shown in Figure 3(a) are in contact with at least one residue of a ligand according to this criterion.
In order to access and exploit the SH3/peptide interaction data obtained by phage display, we de®ned two SH3 and peptide residues as being in virtual contact if: (1) the SH3 sequence can be aligned to the multiple alignment shown in Figure 3(a); (2) the peptide sequence can be aligned to at least one of the peptides of the SH3/ peptide complexes of known structure; and (3) the SH3 and the peptide were experimentally shown to interact.
The SH3 and peptide residues contact positions are identi®ed by the SH3 and peptide multiple sequence alignments, respectively.
The de®nition of virtual contact is supported by the theoretical basis of homology modelling. An SH3 sequence which can be aligned to a multiple alignment of SH3 domains of known structure can be homologymodeled with high reliability, depending on its sequence similarity to the template structure (Sali, 1995; Srinivasan et al., 1996). A polyproline sequence which has been shown to interact with an SH3 domain in a phage display experiment is very likely to assume a polyproline II structure. It is therefore reasonable to assume that the contact pattern identi®ed on the crystal structures of a number of complexes is conserved in the homologous sequences and can be extended to the phage display interaction data.
Virtual contacts between SH3 domains and peptide positions PÀ5 and PÀ6 in the class II orientation have been assigned as shown in Figure 3(b). The choice was driven by the observation that the contacts common to class I and class II orientations are always de®ned, in the peptide positions ranging from P3 to PÀ4, by high numbers of atomic contacts in the complex crystal structures. Correlation tests performed with matrices built with this rationale can predict class II orientation speci®city also for peptide positions PÀ5 and PÀ6 and perform better than the corresponding matrices de®ned only with contacts detected in the crystal structures (i.e. lacking class II contacts in the PÀ5 and PÀ6 peptide positions). Moreover,

326

Prediction of SH3 Domain Speci®city

this modi®cation allowed us to afford the prediction of speci®city for a few SH3 domains of the Src family where the two positions discussed are known to be important in modulating peptide recognition, as described in Results.
Construction of an SH3-specific matrix of frequencies of residue-residue contacts
In a complex of known structure, the contacts between residues in speci®c positions of the SH3 sequences are easily identi®ed, as already explained. We may therefore consider a contact table (Figure 3(b)) where different columns identify the 27 SH3 contact positions and different rows identify the ten peptide positions. Some elements of this table are ``closed'' (in grey in Figure 3(b)) because they represent SH3 and peptide positions which are too far to be in contact. Other elements, representing observed SH3/peptide contact positions, are ``open'' (in white in Figure 3(b)).
Each open position of the 27 Â 10 table corresponds to a 20 Â 20 matrix describing all the possible residue/residue contacting pairs found in the SH3/peptide complexes (Figure 3(c)). In the different positions of this 27 Â 10 Â 20 Â 20 interaction scheme, we calculated the frequencies of occurrence of the observed residue/residue pair in experiments in which SH3 ligands were obtained by searching combinatorial peptide libraries displayed on ®lamentous phage capsid. We called this scheme of observed interactions between SH3 domains and peptides ``SH3-speci®c matrix''.
Evaluation of probabilities of interaction between an SH3 sequence and a decapeptide, a protein sequence, a database of protein sequences
In order to evaluate the probability of interaction between an SH3 sequence and a ten residue peptide, we perform the following procedure: (1) the query SH3 sequence is manually aligned to the multiple alignment shown in Figure 3(a) and the 27 SH3 contacting positions are assigned; (2) the SH3-speci®c matrix is accessed and the sum of the frequencies corresponding to the residues of the chosen SH3 and peptide is scored.
To evaluate the probability of interaction between an SH3 domain and a protein sequence or a database of protein sequences, the procedure scans the protein sequence or sequences in ten residue long peptides at one residue steps. A simple computer program may also access the matrix in order to calculate, for each SH3 domain, the best ranking residues in the different positions of the peptide sequence (Table 4). The peptide composed of the best ranking residues is the best ranking peptide and it is used to normalize the scores of each single SH3 domains.
SH3 domains can bind to polyproline II peptides in two different orientations
SH3 domains may bind to peptides in polyproline II conformation in two different and opposite orientations (Lim et al., 1994, Yu et al., 1994), identi®ed as class I and class II orientations. We analysed the contact schemes related to the different orientations and describe in the Results section the differences and similarities between the two SH3-speci®c contact schemes. The SH3-SPOT procedure scores each decapeptide in both orientations, using class I and class II SH3-speci®c matrices.

Correlation between expected and observed results

In order to test SH3-SPOT predictive power, we built different SH3-speci®c matrices, calculated either using all the experimental data about preferred SH3 ligands or a subset of these.
We selected ®ve SH3 domains of the src family (1ad5, 1fmk, 1fyn, 1lyn and 1yes) and, for each single SH3 sequence, we ran a FASTA sequence comparison versus the sequences of the other four members of the family. Different SH3-speci®c matrices were built for each query SH3 domain, obtained by adding the interaction data related to the other members of the family according to an increasing sequence similarity to the query SH3 domain. For instance, when using the Src SH3 sequence (1fmk) as query SH3 domain, we built a À5 matrix obtained from all the SH3/peptide interaction data except those related to the 1lyn, 1ad5, 1fyn, 1yes and 1fmk SH3 domains. A À4 matrix was built adding to the À5 matrix the SH3 interaction data related to the SH3 domain displaying the lowest degree of sequence similarity to the the query sequence (1lyn). The À3, À2 and À1 matrices were built by adding the interaction data related to 1ad5, 1fyn and 1yes to the preceding matrices. The order was chosen according to the increasing sequence identity with the 1fmk SH3 domain.
The same protocol, mutatis mutandis, was used for the other members of the Src and Abl families. The different matrices were then used to rank the peptides present in our peptide database, composed of a grand total of about 319 peptides (Table 3 and Figure 5).
The correlation between the peptide sequences found in the phage display data and the best scoring peptides obtained using the different SH3-speci®c matrices was calculated according to the formula:

rXYY



covXY Y sÃX sY

(see Figure 4(c)), where X is the ensemble of the input values (Figure 4(a)), Y is the ensemble of the output values (Figure 4b), cov(X,Y) is X and Y covariance, sx and sY are the standard deviations of the X and Y values, respectively.

Acknowledgments
The authors are grateful to Dr A. M. Lesk for helpful advice and discussion and for critically reading the manuscript. We are grateful to Luisa Montecchi Palazzi for valuable help. This work was supported by C.N.R. (target project Biotechnology) to M.H.C. and G.C.; the EU Biotechnology Program Framework 4 and AIRC. We would like to thank the members of the Molecular Genetics lab for providing experimental results before publication.
References
Altschul, S. F., Madden, T. L., SchaÈ ffer, A. A., Zhang, J., Zhang, Z., Miller, W. & Lipman, D. J. (1997). Gapped BLAST and PSI-BLAST: a new generation of protein database search programs. Nucl. Acids Res. 25, 3389-3402.
Ando, A., Yonezawa, K., Gout, I., Nakata, T., Ueda, H., Hara, K., Kitamura, Y., Noda, Y., Takenawa, T.,

Prediction of SH3 Domain Speci®city

327

Hirokawa, N., et al. (1994). A complex of GRB2dynamin binds to tyrosine-phosphorylated insulin receptor substrate-1 after insulin treatment. EMBO J. 13, 3033-3038. Bateman, A., Birney, E., Durbin, R., Eddy, S. R., Finn, R. D. & Sonnhammer, E. L. (1999). Pfam 3.1: 1313 multiple alignments match the majority of proteins. Nucl. Acids Res. 27, 260-262. Bernstein, F. C., Koetzle, T. F., Williams, G. J. B., Meyer, E. F., Jr., Brice, M. D., Rodgers, J. R., Kennard, O., Shimanouchi, T. & Tasumi, M. (1977). The Protein Data Bank: a computer-based archival ®le for macromolecular structures. J. Mol. Biol. 112, 535-542. Bunnell, S. C., Henry, P. A., Kolluri, R., Kirchhausen, T., Rickles, R. J. & Berg, L. J. (1996). Identi®cation of Itk/Tsk Src homology 3 domain ligands. J. Biol. Chem. 271, 25646-25656. Cestra, G., Castagnoli, L., Dente, L., Minenkova, O., Petrelli, A., Migone, N., Hoffmuller, U., SchneiderMergener, J. & Cesareni, G. (1999). The SH3 domain of endophilin and amphiphysin bind to the proline rich region of synaptojanin at distinct sites that display an unconventional binding speci®city. J. Biol. Chem. 274, 32001-32007. Cicchetti, P., Mayer, B. J., Thiel, G. & Baltimore, D. (1992). Identi®cation of a protein that binds to the SH3 region of Abl and is similar to Bcr and GAPrho. Science, 257, 803-806. De Rinaldis, M., Ausiello, G., Cesareni, G. & HelmerCitterich, M. (1998). Three-dimensional pro®les: a new tool to identify protein surface similarities. J. Mol. Biol. 284, 1211-1221. Genetics Computer Group (GCG) (1999). Wisconsin Package Version 9.0, , Madison, WI. Holmes, T. C., Fadool, D. A., Ren, R. & Levitan, I. B. (1996). Association of Src tyrosine kinase with a human potassium channel mediated by SH3 domain. Science, 274, 2089-2091. Howlett, C. J., Bisson, S. A., Resek, M. E., Tigley, A. W. & Robbins, S. M. (1999). The proto-oncogene p120 (Cbl) is a downstream substrate of the Hck proteintyrosine kinase. Biochem. Biophys. Res. Commun. 257, 129-138. Hunter, S., Burton, E. A., Wu, S. C. & Anderson, S. M. (1999). Fyn associates with Cbl and phosphorylates tyrosine 731 in Cbl, a binding site for phosphatidylinositol3-kinase. J. Biol. Chem. 274, 2097-2106. Lee, C. H., Saksela, K., Mirza, U. A., Chait, B. T. & Kuriyan, J. (1996). Crystal structure of the conserved core of HIV-1 Nef complexed with a Src family SH3 domain. Cell, 85, 931-942. Lim, W. A., Richards, F. M. & Fox, R. O. (1994). Structural determinants of peptide-binding orientation and of sequence speci®city in SH3 domains. Nature, 372, 375-379. MongiovÁõ, A. M., Romano, P. R., Panni, S., Mendoza, M., Wong, W. T., Musacchio, A., Cesareni, G. & Di Fiore, P. P. (1999). A novel peptide- SH3 interaction. EMBO J. 18, 5300-5309. Musacchio, A., Noble, M., Pauptit, R., Wierenga, R. & Saraste, M. (1992). Crystal structure of a Src-homology 3 (SH3) domain. Nature, 359, 851-855. Musacchio, A., Wilmanns, M. & Saraste, M. (1994a). Structure and function of the SH3 domain. Prog. Biophys. Mol. Biol. 61, 283-97. Musacchio, A., Saraste, M. & Wilmanns, M. (1994b). High-resolution crystal structures of tyrosine kinase SH3 domains complexed with proline-rich peptides. Nature Struct. Biol. 1, 546-551.

Otsu, M., Hiles, I., Gout, I., Fry, M. J., Ruiz-Larrea, F., Panayotou, G., Thompson, A., Dhand, R., Hsuan, J., Totty, N., Smith, A. D., Morgan, S. J., Courtneidge, S. A., Parker, P. J. & Water®eld, M. D. (1991). Characterization of two 85 kd proteins that associate with receptor tyrosine kinase, middle-T/ pp60c-src complexes, and PI3k-kinase. Cell, 65, 91104.
Park, R. K., Kyono, W. T., Liu, Y. & Durden, D. L. (1998). CBL-GRB2 interaction in myeloid immunoreceptor tyrosine activation motif signaling. J. Immunol. 160, 5018-5027.
Pisabarro, M. T. & Serrano, L. (1996). Rational design of speci®c high-af®nity peptide ligands for the AblSH3 domain. Biochemistry, 35, 10634-10640.
Pisabarro, M. T., Serrano, L. & Wilmanns, M. (1998). Crystal structure of the Abl-SH3 domain complexed with a designed high-af®nity peptide ligand: implications for SH3-ligand interactions. J. Mol. Biol. 281, 513-521.
Raabe, T., Olivier, J. P., Dickson, B., Liu, X., Gish, G. D., Pawson, T. & Hafen, E. (1995). Biochemical and genetic analysis of the Drk SH2/SH3 adaptor protein of Drosophila. EMBO J. 14, 2509-2518.
Rickles, R. J., Bot®eld, M. C., Weng, Z., Taylor, J. A., Green, O. M., Brugge, J. S. & Zoller, M. J. (1994). Identi®cation of Src, Fyn, Lyn, PI3k and Abl SH3 domain ligands using phage display libraries. EMBO J. 13, 5598-5604.
Rickles, R. J., Bot®eld, M. C., Zhou, X. M., Henry, P. A., Brugge, J. S. & Zoller, M. J. (1995). Phage display selection of ligand residues important for Src homology 3 domain binding speci®city. Proc. Natl Acad. Sci. USA, 92, 10909-10913.
Sahr, K. E., Laurila, P., Kotula, L., Scarpa, A. L., Coupal, E., Leto, T. L., Linnenbach, A. J., Winckelmann, J. C., Speicher, D. W., Marchesi, V. T., Curtis, P. J. & Forget, B. J. (1990). The complete cDNA and polypeptide sequences of human erythroid alpha-spectrin. J. Biol. Chem. 265, 4434-4443.
Saksela, K., Cheng, G. & Baltimore, D. (1995). Prolinerich (PxxP) motifs in HIV-1 Nef bind to SH3 domains of a subset of Src kinases and are required for the enhanced growth of Nef viruses but not for down-regulation of CD4. EMBO J. 14, 484-491.
Sali, A. (1995). Modeling mutations and homologous proteins. Curr. Opin. Biotechnol. 4, 437-451.
Sparks, A. B., Rider, J. E., Hoffman, N. G., Fowlkes, D. M., Quillam, L. A. & Kay, B. K. (1996). Distinct ligand preferences of Src homology 3 domain from Src, Yes, Abl, Cortactin, p53bp2, Plc-g, Crk and Grb2. Proc. Natl Acad. Sci. USA, 93, 1540-1544.
Srinivasan, N., Guruprasad, K. & Blundell, T. L. (1996). Comparative modelling of proteins. In Protein Structure Prediction, A Practical Approach (Sternberg, M. J. E., Rickwood, D. & Hames, B. D., eds), Oxford University Press, Oxford.
Stahl, M. L., Ferenz, C. R., Kelleher, K. L., Kriz, R. W. & Knopf, J. L. (1988). Sequence similarity of phospholipase C with the non-catalytic region of src. Nature, 332, 269-272.
Trahey, M., Wong, G., Halenbeck, R., Rubinfeld, B., Martin, G. A., Ladner, M., Long, C. M., Crosier, W. J., Koths, K. & McCormick, F. (1988). Molecular cloning of two types of GAP complementary DNA from human placenta. Science, 242, 1697-1700.
Vidal, M., Montiel, J. L., Cussac, D., Cornille, F., Duchesne, M., Parker, F., TocqueÂ, B., Roques, B. P. & Garbay, C. (1998). Differential interactions of the

328

Prediction of SH3 Domain Speci®city

growth factor receptor-bound protein 2 N-SH3 domain with son of sevenless and dynamin. Potential role in the Ras-dependent signaling pathway. J. Biol. Chem. 273, 5343-5348. Wu, X., Knudsen, B., Feller, S. M., Zheng, J., Sali, A., Cowburn, D., Hanafusa, H. & Kuryian, J. (1995). Structural basis for the speci®c interaction of lysinecontaining proline-rich peptides with the N-terminal SH3 domain of c-Crk. Structure, 3, 215-226. Yu, H., Chen, J. K., Feng, S., Dalgarno, D. C., Brauer, A. W. & Schreiber, S. L. (1994). Structural basis for

the binding of proline-rich peptides to the SH3 domains. Cell, 76, 933-945. Ziemnicka-Kotula, D., Xu, J., Gu, H., Potempska, A., Kim, K. S., Jenkins, E. C., Trenkner, E. & Kotula, L. (1998). Identi®cation of a candidate human spectrin Src homology 3 domain-binding protein suggests a general mechanism of association of tyrosine kinases with the spectrin-based membrane skeleton. J. Biol. Chem. 273, 13681-13692.

Edited by J. Thornton

(Received 23 September 1999; received in revised form 7 February 2000; accepted 10 February 2000)

