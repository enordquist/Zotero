PHYSICAL REVIEW A

VOLUME 31, NUMBER 3

MARCH 1985

Canonical dynamics: Equilibrium phase-space distributions
William G. Hoover Department ofApplied Science, University of California at Davis Li—vermore, Livermore, California 94550
(Received 18 September 1984)
Nose has modified Newtonian dynamics so as to reproduce both the canonical and the isothermal-isobaric probability densities in the phase space of an X-body system. He did this by scaling time {with s) and distance (with V' in D dimensions) through Lagrangian equations of motion. The dynamical equations describe the evolution of these two scaling variables and their two
conjugate momenta p, and p„. Here we develop a slightly different set of equations, free of time
scaling. We find the dynamical steady-state probability density in an extended phase space with
variables x, p„, V, e, and g, where the x are reduced distances and the two variables e and g act as
thermodynamic friction coefficients. We find that these friction coefficients have Gaussian distri-
butions. From the distributions the extent of small-system non-Newtonian behavior can be estimat-
ed. We illustrate the dynamical equations by considering their application to the simplest possible case, a one-dimensional classical harmonic oscillator.

I. INTRODUCTION

' Classical "constant-temperature" calculations have been
pursued for over a decade. In this sense, "temperature"

is a measure of the instantaneous kinetic energy in a sys-

tem. Thus the corresponding dynamical equations include

non-Newtonian accelerations designed to keep the kinetic

energy gp /2m constant. The non-Newtonian iso-
thermal accelerations are useful in dissipative systems in-

volving viscous flow, or heat flow, far from equilibrium.

Such systems would heat rapidly in the absence of con-

straints. By now, many

distinct sets of differential

equations of motion have been devised to keep the kinetic

energy constant.

A somewhat different kind of constant-temperature cal-

culation strives to reproduce the canonical phase-space

distribution, so that the kinetic energy can fluctuate, with

a distribution proportional to exp( gp /2mkT—). Ob-

taining the canonical distribution is desirable, at least in

equilibrium work, in order to correlate the results of

many-body simulations with Gibbs's and Jaynes's statisti-

cal mechanics. Andersen has used occasional discontinu-

ous "stochastic" collisions to induce the canonical distri-

bution in many-body simulations.

Nose achieved a major advance by showing that the

canonical distribution can be generated with smooth,

deterministic, and time-reversible trajectories. To do this

he introduced a time-scale variable s, its conjugate

momentum p„and a parameter Q. Nose's augmented

Hamiltonian

HN„; —@(q)+gp /2ms

+(X+1)kTlns+p, /2Q,

contains a nonlinear collective potential in which the
time-scale variable s oscillates. Thus the system, with X
degrees of freedom, is coupled to a heat bath (described by
the variables s and p, ). Nose proved that the microcanonical distribution in the augmented set of variables is equivalent to a-canonical distribution of the variables q,p',

where the p' are the scaled momenta p/s. Thus the Ham-
iltonian (1) generates the canonical probability distribution
independent of the values chosen for H&„e and Q.
During the canonical-ensemble calculations just
described, the volume V and temperature T are held fixed. Nose demonstrated the usefulness of these ideas by carry-
ing out several dense-fluid simulations using the Hamil-
tonian HN„;.
By allowing length to vary, as well as time, Nose generalized this work to include the isothermal-isobaric ensemble. These methods and ideas forge a remarkable link between the ensembles of statistical theory and atomistic dynamics. They suggest promising approaches for the investigation of nonequilibrium systems.
Here we exhibit steady-state (equilibrium) distributions
for the new variables which play the role of thermodynamic friction coefficients. Our equations of motion are very much like Nose s, but differ in that scaling of the time is not required. The new results for distributions make it possible to estimate finite-size effects on dynamical averages. In Sec. II we review Nose's canonical equations of motion and introduce a version of them free of
time scaling. In Sec. III we formulate the phase-space
evolution of the many-body probability density
f~~(q, p, g, Q) and exhibit a steady-state solution. We in-
dicate the straightforward extension to include the isobaric case. With some additional effort, it seems likely that a stress-tensor version of this ensemble could be constructed along the lines pioneered by Rahman and Parrinello. In the final section we illustrate the equations of motion with some representative trajectories for a single classical oscil-
lator.
II. CANONICAL DISTRIBUTION FROM
NON-NE%'TONIAN DYNAMICS (REF. 10)
The equations of motion from Nose's Hamiltonian (1)
are
q=plms, p=F(q), s=p, /Q,
(2)
p, =gp /ms —(X+1)kT!s .

31 1695

Q~1985 The American Physical Society

1696

%'ILLIAM G. HOOVER

31

These coupled first-order equations take a simpler form if
the time scale is reduced by s, so that dt, &d =—s dt„, . All of the rates given in (2) can then be expressed as deriva-
tives with respect to t„, (for which we will still use the
superior dot notation)

q =p/ms, p =sF, s =sp, /Q,

p, =gp~/ms~ (X+1)k—T .

(3)

The somewhat inconvenient variable s can then be eliminated from the equations (3) by rewriting the coordinateevolution equations in terms of q, q, and q'.
: q =p Ims —(pIms)s Is =F/m qp—, /Q =F(q)/m —gq . (4)
The thermodynamic friction coefficient g—p, /Q which
appears in the second-order equations (4) evolves in time according to a first-order equation

gmq —(X+ 1)kT Q.

(5)

Nose showed that the phase-space distribution resulting
from the equations (2) is canonical in the variables q,p/s.
In the next section we show that the distribution resulting
from equations (4) and (5) can be made canonical too, and
— in such a way as to avoid time scaling. To do this we , redefine p= mj and replace Nose's X+1 by X obtain-
ing'

XkT— q=p/m, p=F(q) —gp, g= gp'I m

Q . (6)

Berendsen has just suggested a close relative of (6) in

wAhEickh;„—= ggp

rather than
/2m XkT/2.

g is proportional to —Notice that Berendsen's

equations are not reversible in time. The equations (6) are

much less severely damped than Berendsen's. An extreme

opposite limiting case, in which AEk;„ is identically zero

and time reversibility is retained, has been achieved by set-

ting the friction or, equivalently,

coefficient equal to by "velocity scaling.

("Q' Fp/m)/(gp

/m)

III. PHASE-SPACE EVOLUTION OF furr(q, p, g)
Because the variables q, p, and g used in (6) are in
f dependent, we can easily calculate the components of the
flow of probability density ( q,p, g) in (2X + 1)-
dimensional space. The equations governing the motion in this space are not Hamiltonian. Therefore the derivatives Bq/Bq and Bp/Bp do not generally sum to zero. Thus the analog of Liouville's equation, expressing the conservative flow of probability with time, including flow in the g direction, is
af Iat+q af/aq+p af!ap+gaf Iag
+f[aq/aq+ ap/ap+ aj/ag] =o . (7)
Consider a density function fzvr proportional to the fol-
lowing exponential:
r
f&~ ~ exp — @(q)+gp /2m+Qg~/2 . kT . (8)

The nonvanishing terms in (7) obtained from this density function are as follows:

q af/aq =(flkT)QFplm,
paf /ap =(flkT)g( F—+gp)plm,

af I'ay=(f/kT)

gp—/m+XkT

f ap/ap =(fIkT)( XkTg—) .

Q PQ

Inspection shows that these terms sum to zero, provided

that the coefficient of kT in the dynamical equation (6)

for the friction coefficient is chosen equal to the number

of independent degrees of freedom in the set q,p. In the

usual molecular dynamics simulation, with periodic boun-

— daries, the center of mass and its velocity are fixed so that
this number of degrees of freedom is D (N 1) for a D

dimensional X-body system. Thus the canonical distribu-

tion (8) is a steady equilibrium solution of the flow equa-

tion (7) and satisfies the equations of motion (6).

In commenting on an earlier draft of this manuscript,

Brad Holian pointed out that the phase-space distribution

(8) can be used to deriue the equation of motion for the

friction coefficient g. To see this, note that the canonical

distribution (8) satisfies (7) if, and only if, g follows the relaxation equation (6) of Nose. Thus Nose's canonical

equations of motion are unique Oth. er relaxation equa-

x—: tions, such as Berendsen's, cannot lead to the canonical

distribution (8).

To extend these ideas to the isothermal-isobaric case is

straightforward. Reduced coordinates

q / V' are in-

troduced, as is also a fixed "external pressure" P,„, and

relaxation time ~. The equations of motion

x=p/mV', p=F —(e+g)p, (Q=+p Im XkT, —

e= V/DV, e=(P P,„,)V/dkT, —

(1O)

have the steady equilibrium
cc V ' exp( +IkT), wher—e
4—=&b(xV' )+gp /2m+Qg /2

solution

f&t z.

+De'HkT/2+P, „,V .

IV. CANONICAL HARMONIC OSCILLATOR

To illustrate the changes in viewpoint discovered by Nose we consider a one-dimensional harmonic oscillator
with the mass, force constant, and initial values of q and p all taken to be unity. We consider equations for which the values of q and p have averaged values of unity. The microcanonical equations of motion

9'=p~ p= —0

(12)

generate closed elliptical trajectories in the twodimensional qp phase space. See Fig. 1(a). For this same
oscillator Nose's canonical equations [with X in (2) taken
to be zero and s initially unity] take the form
q=p/s, p= —q, s=p, /Q, p, =p /s —1/s . (13)

31

CANONICAL DYNAMICS: EQUILIBRIUM PHASE-SPACE. . .

1697

(e)

FIG. 1. (a) Elliptical orbit for an oscillator described by Eqs.

(12}. The abscissa is q, the ordinate is p. The major-to-minor axis ratio of unity has been increased in plotting to fit the Tek-

tronix hard-copy screen area symmetrically. This same increase

applies to each figure. All data were obtained on the Digital

Equipment Corporation VAX 11/780 computer at the Physics

Department (Lausanne) using a fourth-order Runge-Kutta in-

tegration in double precision with time steps in the range 0.01

down to 0.001. (b) Long-time qp trajectory for Eqs. (13) or (14)

S(w1ai5mth)ewiianthsiti(aibln)itwivaailtlhuevsaQlueq=s 0=q.11,=. p1(d,=)p1L=o,n1sg,-=t/im=1e,0,p,qap=nd0tr,ajQeacn=tdo1ry.Q

=1. (c)
for Eqs. (e) Same

as (d) with Q =0.1.

For large Q these equations simply reproduce the microcanonical behavior shown in Fig. 1(a). In Figs. 1(b) and
l(c) we show trajectories for Q =1.0 and 0.1 using the
same initial conditions. For the larger Q, the trajectories in qp space gradually fill in a region between two limiting curves. For the smaller Q the trajectories develop more nearly singular turning points and the size of the filled re-
gion diminishes. When a new time is introduced, with
dto1d =sdtnew and

q =p /s, p = —qs, s =sp, /Q, p, = (p /s) 2 —1,

exactly the same trajectories are produced, but at different

rates. This is a good check of the numerical integration.

Finally, if we abandon time scaling and redefine p =q

we have

q=p p= q —SS» —P=(p' —1)/Q.

(15)

Solutions for these equations appear in Figs. 1(d) and 1(e). The small-Q limit of (15) can be inferred from these fig-
ures. The oscillator moves between widely-separated turn-
ing points at velocity +1.
These examples illustrate that a single oscillator is not
sufficiently chaotic to reproduce the canonical distribu-
tion from a single initial condition. The trajectories are, however, stable and cover a relatively large part of the os-
cillator phase space for reasonable values of the parameter Q. For unreasonable values of Q (either very small or
very large) it is not at all clear that even large systems will behave in a canonical (as opposed to microcanonical) way. A study of the number dependence and Q dependence of
the phase-space density for a series of small systems
might help to clarify this point.

ACKNOWLEDGMENTS
It is a pleasure to thank Shuichi Nose and Carl Moser for stimulating conversations at the 1984 Centre Europeen
de Calcul Atomique et Moleculaire (Orsay, France) Workshop on Constrained Dynamics. Professor Nose kindly made several comments, correcting and clarifying a previous version of this manuscript. Professor Philippe Choquard kindly provided local support and facilities for this work at Laboratoire de Physique Theorique, Ecole Polytechnique Federale de Lausanne, Switzerland. The
— Academy of Applied Science supported related work at
the University of California at Davis Livermore as well as the cost of travel between California and Europe. This
work was partially supported by the Lawrence Livermore
National Laboratory under the auspices of the U.S. Department of Energy under Contract No. W-7405ENG-48.

W. T. Ashurst and W. G. Hoover, Phys. Rev. Lett. 31, 206
(1973).
L. V. Woodcock, Chem. Phys. Lett. 10, 257 (1971).
3D. J. Evans, J. Chem. Phys. 78, 3297 (1983). 4W. G. Hoover, A. J. C. Ladd, and B. Moran, Phys. Rev. Lett.
48, 1818 (1982).
5J. M. Haile and S. Gupta, J. Chem. Phys. 79, 3067 (1983). See H. J. C. Berendsen, J. P. M. Postma, W. F. van Gunsteren, A. DiNola, and J. R. Haak, J. Chem. Phys. 81, 3684 (1984).

For an oscillator this "new" approach gives (Lord) Rayleigh's
equation [Philos. Mag. 15, 229 (1883)].
7H. C. Andersen, J. Chem. Phys. 72, 2384 (1980) and references
quoted therein.
8S. Nose, Mol. Phys. 52, 255 (1984). M. Parrinello, A. Rahman, and P. Vashishta, Phys. Rev. Lett.
50, 1073 (1983) and references quoted therein.
'oSti.oNnsoseeq, uJiv.aClehnetm.toP(h2y)s—. (86)1., 511 (1984). See Sec. II B for equa-

