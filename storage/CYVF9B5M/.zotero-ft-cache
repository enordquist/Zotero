760 Acta Cryst. (1994). Dr0, 760-763
The CCP4 Suite: Programs for Protein Crystallography
BY COLLABORATIVE COMPUTATIONAL PROJECT, NUMBER 4*
SERC Daresbury Laboratory, Warrington WA4 4AD, England
( R e c e i v e d 8 D e c e m b e r 1993; a c c e p t e d 21 M a r c h 1994)

Abstract
The CCP4 (Collaborative Computational Project, number 4) program suite is a collection of programs and associated data and subroutine libraries which can be used for macromolecular structure determination by X-ray crystallography. The suite is designed to be flexible, allowing users a number of methods of achieving their aims and so there may be more than one program to cover each function. The programs are written mainly in standard Fortran77. They are from a wide variety of sources but are connected by standard data file formats. The package has been ported to all the major platforms under both Unix and VMS. The suite is distributed by anonymous ftp from Daresbury Laboratory and is widely used throughout the world.
Introduction
CCP4 (Collaborative Computational Project, number 4) was established in 1979 and involved a group of protein crystallographers who have pooled their programming effort and expertise to create a suite of computer programs for the processing and analysis of protein crystallographic data. The project started in the UK, supported by the Science and Engineering Research Council (SERC), but is now integrated with the European Science Foundation (ESF) Network of the European Association of the Crystallography of Biological Macromolecules (EACBM).
The CCP4 program suite is a set of separate programs which communicate via standard data file formats. The advantage of this organization is that it is easy to add new programs or to modify existing ones without interfering with the other parts of the suite and it is possible to combine programs in new ways, linked by the Unix shell or VMS command language. Most of the computer code is written in standard Fortran77 and conversion of new programs to follow the CCP4 standard is relatively staightforward providing that they are written in standard Fortran77.
* Contact person S. Bailey (CCP4 Secretary), SERC Daresbury Laboratory, Warrington WA4 4AD, England.

Table 1. Examples of protein structures recently determined using CCP4 programs

Protein
8-Endotoxin U I small nuclear ribonucleoprotein-A Fl ATPase Galactose oxidase Mouse major urinary protein Chicken annexin V Mouse DHFR Tyrosine phenol-lyase Rubredoxin Aldose reductase N|I-Domain from duck ovotransferrin Concanavalin A Trypanothione reductase Ribulose 1,5-biphosphate carboxylase/oxygenase E. coli triosephosphate isomerase Carboxypeptidase A/L-phenyl lactate complex Rat CD4, domains 3 and 4 Chimeric Fab' fragment Human H ferritin Glutamate dehydrogenase

Reference
Li et al. (1991) Nagai et al. (1990) Abrahams et al. (1993) lto et al. (1991) Bocskei et al. (1992) Bewley et al. (I 993) Groom et al. (1991) Antson et al. (1992) Dauter et al. (1992) T6te-Favier et al. (1993) Lindley et al. (1993) Naismith et al. (1993) Hunter et al. (1992) Newman et al. (1993) Noble et al. (1993) Teplyakov et al. (1993) Brady et al. (1993) Brady et al. (1992) Lawson et al. (1991) Baker et al. (1992)

Briefly, the suite contains programs for the reduction and analysis of intensity data, structure solution by isomorphous replacement and molecular replacement, least-squares refinement and analysis of the structure. There are programs for displaying electron-density maps and plotting molecules. The suite has been used for the determination and refinement of a large number of protein structures, of which some recent examples are listed in Table 1.
The program suite
The program package comprises several different elements which are briefly described.
Programs
The programs have been collected from a variety of sources and cover most aspects of macromolecular crystallography, with alternatives for some processes. They are distributed by CCP4 thanks to the generosity of the program authors. Table 2 lists the programs which are currently distributed as part of the suite.

COLLABORATIVE COMPUTATIONAL PROJECT, NUMBER 4

761

Table 2. CCP4 programs and their functions

Program
A BSCA LE ABSURD ACT AG RO VA TA/ RO TA VA TA ALMN AMORE CAD COMPLETE CONTA CT COORDCON V DISTA NG ECA LC EN VELOPE EXTEND F2M TZ FFT, FFTBIG FHSCA L FLA TMA P GENS YM HEA VY HKLPLOT ICO EFL LCF2MTZ LSQKAB MA PSIG MAPTONA4 MLPHA RE M TZ2 VA RIO US MTZDUMP MTZTONA4, NA4TOMTZ MTZUTILS 0 VERLA PMA P PDBSET PEA KMA X PLTDEV NPO POLA RRFN POSTREF PRMAP PROCHECK PROLSQ PRO TIN REINDEX RO TA PREP RO TMA T RSEA RCH RSPS RSTA TS SCA LEIT SFALL SIGMA A SO R TM TZ SURFA CE TFFC TRACER
TR UNCA TE UNDUPL UNIQUE VECREF VECTORS VOLUME WA TERSORT WA TER TID Y WA TPEA K WIL SO N

Function
Film and image-plate scaling Initial processing of intensity files from M A D N E S Analysis of coordinates Scaling intensities and averaging repeated measurements Crowther's rotation function using FFT Molecular replacement Collecting assorted reflection data Statistics on completeness of the data set Calculates contacts in protein structure lnterconverts various coordinate formats Distances and angles in protein molecule Calculates normalized structure amplitudes Generates molecular envelope for solvent flattening Extends map to specified volume of the unit cell Converts a formatted reflection file to MTZ file Crystallographic fast Fourier transformation Scaling derivative to native by Kraut's method Flattens solvent region of electron-density map Generate sites by symmetry Heavy-atom refinement and phasing program Plots a pseudo-precession picture from a reflection file Scaling of multiple F ~ s to F,,~ Converts an LCF reflection file to MTZ one Optimize fit of atomic coordinates from two data sets Print statistics on signal/noise for translation-function map Converts binary map file to na4 format and reverse Phase calculation and refinement Makes ASCII reflection files from MTZ file Displays the contents of the MTZ file Transforms MTZ file to transferable ASCII file and reverse Reflection data file utility program Calculate the overlap of two maps Various useful manipulations on coordinate files Search for peaks in the electron-density map Convert plot84 metafiles to other graphics formats Plot molecules and electron-density maps Fast rotation function in polar coordinates Post-refinement of film data Prints sections of electron-density maps Protein stereochemistry checking Structure refinement Prepares file with restraints for P R O L S Q Reindex MTZ reflections file Produces multirecord MTZ file Interconverts CCP4/MERLOT/X-PLOR rotation angles R-factor search Heavy-atom positions from derivative difference Patterson maps Scales two data sets Various derivative and native scaling Structure-factor calculations using FFT Phase combination Sorting MTZ file Accessible surface area Translation function Reduced cell calculations Converts intensities to amplitudes Remove duplicates from MADNES data, after ABSURD Generate unique reflection data set Vector space refinement of the heavy atoms Generates Patterson vectors from atomic coordinates Polyhedral volume around selected atoms Assign waters to nearest protein atoms Rearranges water position Selects peaks Produces Wilson plot

Program reference (if program published)
Crowther (1972) Navaza (1990)
Wang (1985), Leslie (1987) Ten Eyck (1973) Wang (1985), Leslie (1987) Terwilliger & Eisenberg (1983, 1987) Kabsch (1978) Otwinowski (1991)
Winkler et al. (1979) Laskowski et al. (1993) Hendrickson (1985) Hendrickson (1985)
Knight (1989)
Read (1986) Tickle (1992) French & Wilson (1978) Tickle ( 1991)

Library
CCP4 maintains a library of subroutines for performing the basic crystallographic and programming operations. There are routines for reading and writing the standard format files for reflections, atomic

coordinates, maps and plotting, and routines for parsing the keyworded input. The library also contains forward and reverse fast Fourier transform routines (Ten Eyck, 1973), routines for handling crystallographic symmetry, some mathematical

762

THE CCP4 SUITE

functions and a small number of machine-specific routines.
Documentation
The documentation is in several sections. The CCP4 manual describes installation and gives an overview of the suite with information on how to use the programs to perform various tasks. There is specific documentation for the individual programs, which is available in the form of 'man' pages on Unix systems, and there is documentation for the subroutine libraries. The suite also contains example files for many crystallography procedures and related test data.
Using the programs
In order to use the programs certain environment variables need to be set to appropriate values. A setup script is supplied to do this. It requires initial modification to adapt it to an individual system and should be executed by CCP4 users when they log in. The programs are run interactively or in batch mode using shell scripts with Unix systems and command files with VMS systems. Example scripts and command files are distributed which can be modified by the user. The control data for most programs is keyworded and is of the form of records with a leading keyword, usually followed by arguments which might be numbers or strings or keyword/value pairs. Log files are produced which contain information on the progress of the program and which may be printed. Tables within the log files are formatted so that statistics can be extracted and plotted as graphs using the facility Xloggraph which is supplied with the suite.

comprise two classes of record; header records and reflection data records. The header records contain information such as titles, cell parameters and symmetry operators. The reflection data are stored notionally as columns of real numbers, each referred to by an alphanumeric label. The first three columns are usually the Miller indices of the reflection, with labels H, K and L. The programs allow the user to set up a correspondence between the labels in the data file and names of the data columns expected by the program. Standard MTZ files have one record per reflection. However, during the initial data processing, unmerged data are stored in multirecord files in which each record represents one observation.
The standard format adopted for coordinate data is that used in the Brookhaven Protein Data Bank (Abola, Bernstein, Bryant, Koetzle & Wang, 1987; Bernstein et al., 1977). The programs of the suite will handle either complete files or files containing only a subset of the types of records which may be present in a complete file, usually the ATOM and H E T A T M records. There is an intention to move to the CIF format when this becomes the standard format for storage of macromolecular coordinate data.
Maps are stored in a randomly accessible binary file as a three-dimensional array preceded by a header which contains all the necessary information about the map including dimensions of the array, cell parameters, symmetry information and maximum, minimum and mean density values. CCP4 currently uses a graphics metafile format called PLOT84 and routines are supplied for its implementation. Programs are distributed to convert PLOT84 into other graphics formats including PostScript.
Installation

File formats
There are four types of file format for reflection data, map data, coordinate data and graphics metafiles. The coordinate data files are ASCII but the map and reflection data files are binary. The binary format is compact and can be read fast without loss of numerical accuracy relative to a text format. To ease the transfer of binary files, the file headers contain information about the computer on which they were created. This information is used by the subroutines which read and write reflection files to allow files created by CCP4 programs to be used by CCP4 programs on most types of computer in a manner which is transparent to the user.
The reflection file format is known as MTZ and it uses fixed length records with, in general, four bytes for each data item, with a minimum of three and a maximum of 200 data items per record. The files

The program suite has been implemented on a large number of hardware platforms under the Unix and VMS operating systems. Installation is straightforward and full instructions are given in the CCP4 manual. Installation under Unix utilizes a script to configure to the appropriate hardware and operating system variant prior to building. Command files are provided to carry out the installation under VMS. A small number of the library routines and one of the programs are written in C.
Distribution
The program suite is licensed free to academic institutes by Internet ftp or on a variety of media for a small handling/media charge. The programs may be obtained by Internet ftp from anonymous@ccp4.dl.ac.uk:pub/ccp4. Separate arrangements are made for commercial organizations who

COLLABORATIVE COMPUTATIONAL PROJECT, NUMBER 4

763

should contact CCP4 directly. For further details about CCP4 or to obtain the programs please contact the CCP4 Secretary at Daresbury Laboratory (email: ccp4@dl.ac.uk).
A large number of people have contributed to CCP4 over the years and we thank them for their time and effort. CCP4 is supported by the SERC and the ESF Network of the EACBM.
References
ABOLA, E., BERNSTEIN,F. C., BRYANT, S. H., KOETZLE,T. F. & WANG, J. (1987). Crystallographic Databases - Information Content, Software Systems, Scientific Applications, edited by F. H. ALLEN, G. BERGERHOFF& R. SILVERS,pp. 107-132. Bonn/ Cambridge/Chester: Data Commission of the International Union of Crystallography.
ABRAHAMS, J. P., LETTER, R., TODD, R. J., VAN RAAIJ, M. J., LESLIE, A. G. W. & WALKER, J. E. (1993). EMBO J. 12, 1775-1780.
ANTSON, A. A., STROKOPYTOV, B. V., MURSHUDOV, G. N., ISUPOV, M. N., HARUTYUNYAN, E. H., DEMIDKINA, T. V., VASSYLYEV, D. G., DAUTER, Z., TERRY, H. & WILSON, K. (1992). FEBS Lett. 302, 256-260.
BAKER, P. J., BRITTON, K. L., ENGEL, P. C., FARRANTS,G. W., LILLEY, K. S., RICE, D. W. & ST1LLMAN,T. J. (1992). Proteins Struct. Funct. Genet. 12, 75-86.
BERNSTEIN,F. C., KOETZLE,T. F., WILLIAMS,G. J. B., MEYER,E. F., BRICE, M. D., ROGERS,J. R., KENNARD,O., SHIMANOUCHI, T. & TASUMI,M. (1977). J. Mol. Biol. 112, 535-542.
BEWLEY,M. C., BOUSTEAD,C. M., WALKER,J. H. & WALLER,D. A. (1993). Biochemistry, 32, 3923-3929.
BOCSKEI, Z., GROOM, C. R., FLOWER, D. R., WRIGHT, C. E., PHILLIPS, S. E. V., CAVAGGIONI, A., FINDLAY, J. B. C. & NORTH, A. C. T. (1992). Nature (London), 360, 186-188.
BRADY, R. L., DODSON,E. J., DODSON,G. G., LANGE,G., DAVIS, S. J., WILLIAMS,A. F. & BARCLAY,A. N. (1993). Science, 260, 979-983.
BRADY, R. L., EDWARDS, O. J., HUBBARD, R. E., JIANG, J.-S., LANGE, G., ROBERTS,S. M., TODD, R. J., ADAIR,J. S., EMTAGE, J. S., KING, D. J. & LOW, D. C. (1992). J. Mol. Biol. 227, 253-264.
CROWTHER, R. A. (1972). The Molecular Replacement Method, edited by M. G. ROSSMANN,pp. 173-178. New York: Gordon and Breach.
DAUTER, Z., SIEKER, L. C. & WILSON, K. S. (1992). Acta Cryst. B48, 42-59.
FRENCH, G. S. & WILSON,K. S. (1978). Acta Cryst. A34, 517-525. GRIX)M, C. R., THILLET, J., NORTH, A. C. T., PICTET, R. &
GEDDES, A. J. (1991). J. Biol. Chem. 266, 19890-19893. HENDRICKSON,W. A. (1985). Methods Enzymol. 115, 252-270.

HUNTER, W. N., BAILEY, S., HABASH, J., HARROP, S. J., HELLIWELL,J. R., ABOAGYE-KWARTENG,T., SMITH, K. & FAIRLAMB,A. H. (1992). J. Mol. Biol. 227, 322-333.
ITO, N., PHILLIPS,S. E. V., STEVENS,C., OGEL, Z. B., MCPHERSON, M. J., KEEN,J. N., YADAV,K. D. S. & KNOWLES,P. F. (1991). Nature (London), 350, 87-90.
KABSCH,W. (1978). Acta Cryst. A32, 922-923. KNIGHT, S. (1989). PhD thesis, Swedish Univ. of Agricultural
Sciences, Uppsala, Sweden. LASKOWSKI, R. A., MACARTHUR, M. W., Moss, D. S. &
THORNTON, J. M. (1993). J. Appl. Cryst. 26, 283-291. LAWSON, D. M., ARTYMIUK,P. J., YEWDALL,S. J., SMITH, J. M.
A., LIVINGSTONE,J. C., TREFFRY, A., LUZZAGO, A., LEVI, S., AROSIO, P., CESARENI, G., THOMAS, C. D., SHAW, W. V. & HARRISON, P. M. (1991). Nature (London) 349, 541-544. LESLIE,A. G. W. (1987). Acta Cryst. A34, 134--136. LI, J., CARROLL,J. & ELLAR, D. J. (1991). Nature (London), 353, 815-821. LINDLEY, P. F., BAJAJ, M., EVANS, R. W., GARRATT, R. C., HASNAIN, S. S., JHOTI, H., KUSER, P., NEU, M., PATEL, K., SARRA, R., STRANGE, R. & WALTON, A. (1993). Acta Cryst. 1949, 292-304. NAGAI, K., ONBRIDGE, C., JESSEN,T. H., LI, J. & EVANS, P. R. (1990). Nature (London), 348, 515-520. NAISMITH, J. H., HABASH, J., HARROP, S., HELLIWELL, J. R., HUNTER,W. N., WAN,T. C. M. & WEISGERBER,S. (1993). Acta Cryst. D49, 561-571. NAVAZA,J. (1990). Acta Cryst. A46, 619-620. NEWMAN, J., BR.ANDI~N,C.-I. & JONES, T. A. (1993). Acta Cryst. D49, 548-560. NOBLE, M. E. M., ZEELEN,J. PH., WIERENGA, R. K., MAINFROID, V., GORAJ, K., GOHIMONT,A. C. & MARTIAL,J. A. (1993). Acta
Cryst. D49, 403-417. OTWINOWSKI, W. (1991). Isomorphous Replacement and
Anomalous Scattering, Proceedings of the CCP4 Study Weekend, edited by W. WOLF, P. R. EVANS& A. G. W. LESLIE,pp. 80-86. Warrington: SERC Daresbury Laboratory. READ, R. J. (1986). Acta Cryst. A42, 140-149. TEN EYCK, L. (1973). Acta Cryst. A33, 486-492. TEPLYAKOV,A., WILSON,K. S., ORIOLI, P. & MANGARI,S. (1993). Acta Cryst. D49, 534-540. TERWILLIGER, T. C. & EISENBERG, D. (1983). Acta Cryst. A39, 813-817. TERWILLIGER, T. C. & EISENBERG, D. (1987). Acta Cryst. A43, 6-13. Tf~TE-FAVIER, F., RONDEAU,J.-M., PODJARNY,A. & MORAN, D. (1993). Acta Cryst. D49, 246-256. TICKLE, I. J. (1991). Isomorphous Replacement and Anomalous Scattering, Proceedings of the CCP4 Study Weekend, edited by W. WOLF, P. R. EVANS& A. G. W. LESLIE.pp. 87-95. Warrington: SERC Daresbury Laboratory. TICKLE, I. J. (1992). Molecular Replacement, Proceedings of the CCP4 Study Weekend, edited by E. J. DODSON,S. GOVER& W. WOLF, pp. 20--32. Warrington: SERC Daresbury Laboratory. WANG, B. C. (1985). Methods Enzymol. 115, 90-112. WINKLER, F. K., SCHUTT, C. E. & HARRISON,S. C. (1979). Acta Cryst. A35, 901-91 I.

